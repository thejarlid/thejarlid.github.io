{"componentChunkName":"component---src-templates-blog-template-js","path":"/Auto_Directed_Video_Stabilization/","result":{"data":{"markdownRemark":{"html":"<p>Since my junior year of college I’ve been in love with the field of Computer Vision and low level image processing. While working on my final project for the class I came across this paper, <em>Auto-Directed Video Stabilization with Robust L1 Optimal Camera Paths,</em> from Google (<a href=\"https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/37041.pdf\">https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/37041.pdf</a>). With the quarantine I finally had time to revisit the paper and thoroughly read it. In this post I want to try to summarize my learnings and present the ideas in a more bitesized layman's term format. </p>\n<h2>Background</h2>\n<p>Throughout the Computer Vision class, the assignments had us build up an image processing library in C++ notably including edge/feature detection, optical flow,  and panorama stitching. Our final project was open ended and I chose to implement video stabilization using many of the previous assignments as building blocks. It was while researching existing methods that I came across the paper from Google. </p>\n<p>However, having decided to attack the problem with two days till the deadline, as every college student does, I read the paper quite fast glancing over the details and focused on trying to pull out the major ideas. To be absolutely honest once I got to the section on Linear Programming the details largely flew over my head, but I was able to gather three major steps:</p>\n<ol>\n<li>Estimate Original Path</li>\n<li>Calculate smooth path</li>\n<li>Warp each frame to the new path </li>\n</ol>\n<p>I was on the right track with the first and third step in my initial implementation. I used my Harris corner detector to find feature points in each frame and using code for panorama stitching I extracted feature matches between frames using RANSAC to keep inliers. With the matches I then calculated a homography between each frame pair to describe the motion of pixels. Where my implementation differed was on the second step; having homographies <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>H</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>H</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">H_1, H_2, …, H_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> I had an estimated camera trajectory for n frames and my idea was that for each homography I would replace it with a new homography computed as the gaussian average over a window of neighboring homographies. I would then use this new series of homographies as the smooth path and fill in frames by using using the inverse matrix of each homography and bilinear interpolation to projecting backwards and fill in each pixel value. </p>\n<p>My hypothesis was that the larger the window the more prior and preceding information homographies at each time step would have and the smoother the resulting curve would be. The implementation worked in the sense that I could form a new video but the results were far from desirable. The result was that high frequency and jarring jitter was suppressed rather than eliminated and in reality the overall videos were not much of an improvement. Some segments did see improvements, but the lack of consistency acted as a counterweight making it more difficult to watch. </p>\n<p>If you’re interested in the image processing library and the code behind this implementation  you can see it here: <a href=\"https://github.com/thejarlid/ImgLib_VideoStabilization\">https://github.com/thejarlid/ImgLib_VideoStabilization</a> </p>\n<h2>Diving into the paper and reimplementation</h2>\n<p>The high level idea in the paper is to replace ‘handheld’-like footage with motion that mimics professional cinematography techniques. Taking original motion of the camera the method aims to fit segments with either constant, linear, or parabolic trajectories. This graph from the paper helps to visualize the objective. </p>\n<p><img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591310002620_Screen+Shot+2020-06-04+at+3.23.45+PM.png\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></p>\n<p>Like in my initial implementation there are three distinct phases of the video stabilization pipeline presented in the paper and I’ll go through each one independently below.</p>\n<h3>Estimate Original Path</h3>\n<p>Like any problem, the first step is to understand what we are trying to solve and in this case that comes in the form of the original camera motion. The motion of the camera is defined as the sequence of homographies between each frame for n frames we will have (n-1) homographies; <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>H</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>H</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">H_1, H_2, …, H_{n-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span>. In the paper and my implementation we use an affine homography which is a special case of a homography of the form: </p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo fence=\"true\">∣</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>b</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>t</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>c</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>d</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>t</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">∣</mo></mrow><annotation encoding=\"application/x-tex\"> \\begin{vmatrix}\na &amp; b &amp; tx\\\\\nc &amp; d &amp; ty\\\\\n0 &amp; 0 &amp; 1\n\\end{vmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.636em;vertical-align:-1.5500299999999998em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.08597em;\"><span style=\"top:-1.05597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-1.6619700000000002em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.26797em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.87397em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.47997em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-4.08597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500299999999998em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">a</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">c</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">b</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">d</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">x</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.08597em;\"><span style=\"top:-1.05597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-1.6619700000000002em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.26797em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.87397em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.47997em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-4.08597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500299999999998em;\"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>The affine transform has 6 degrees of freedom as opposed to 8 degrees available with the general homography and also preserves parallelism in its warps. If you’re interested in the details behind homographies I recommend going through the slides here: (<a href=\"https://docs.google.com/presentation/d/1V_8vwkIAEOuDAXZyJCBCplbst1A2to2JsoBSteVZYZ4/edit#slide=id.g3813390b8a_0_48\">https://docs.google.com/presentation/d/1V_8vwkIAEOuDAXZyJCBCplbst1A2to2JsoBSteVZYZ4/edit#slide=id.g3813390b8a_0_48</a>). </p>\n<p>To find the motion between a pair of subsequent frames we begin by detecting feature points in each frame and then trying to match the corresponding feature points. Feature point detection is a whole subspace within image processing and computer vision an incredibly interesting one too that I recommend taking a dive into. As opposed to the Harris Corner Detector used in my initial implementation I opted for ORB since it was open source, fast, and more robust. </p>\n<p>Once feature points are extracted from all frames we can attempt to match these feature between subsequent frame pairs. The computation to determine a match differs between detection algorithms because of the way each chooses to describe a feature and so I won’t go into it here. Another important point is that it’s common for the a match to be wrong. Below are some of the matches I extracted between frames and you can see while in the first pair the matches mostly consistent whereas in the second there are a few outliers. </p>\n<p><img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591335922876_matches_541-542.jpg\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></p>\n<p><img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591335939318_matches_717-718.jpg\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></p>\n<p>With the matches we can now solve for the homography between the two frames. The computation comes down to a system of equations. Remember the form for a homography is </p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>H</mi><mo>=</mo><mrow><mo fence=\"true\">∣</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>b</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>t</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>c</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>d</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>t</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">∣</mo></mrow></mrow><annotation encoding=\"application/x-tex\"> H = \\begin{vmatrix}\na &amp; b &amp; tx\\\\\nc &amp; d &amp; ty\\\\\n0 &amp; 0 &amp; 1\n\\end{vmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.636em;vertical-align:-1.5500299999999998em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.08597em;\"><span style=\"top:-1.05597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-1.6619700000000002em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.26797em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.87397em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.47997em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-4.08597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500299999999998em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">a</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">c</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">b</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">d</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">x</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.08597em;\"><span style=\"top:-1.05597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-1.6619700000000002em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.26797em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.87397em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.47997em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-4.08597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500299999999998em;\"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>H</mi><mi>x</mi><mo>=</mo><mi>x</mi><mi mathvariant=\"normal\">’</mi></mrow><annotation encoding=\"application/x-tex\">Hx = x’</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathdefault\">x</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span><span class=\"mord\">’</span></span></span></span> s.t <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span> is a homogenous coordinate vector <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo fence=\"true\">∣</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">∣</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{vmatrix} x \\\\ y \\\\ 1 \\end{vmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.636em;vertical-align:-1.5500299999999998em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.08597em;\"><span style=\"top:-1.05597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-1.6619700000000002em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.26797em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.87397em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.47997em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-4.08597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500299999999998em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.08597em;\"><span style=\"top:-1.05597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-1.6619700000000002em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.26797em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.87397em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.47997em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-4.08597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500299999999998em;\"><span></span></span></span></span></span></span></span></span></span></span> </p>\n<p>When you take <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span></span></span></span> and multiply it by a homogenous co-ordinate <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span> we would hope to obtain <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>x</mi><mi mathvariant=\"normal\">’</mi></mrow><annotation encoding=\"application/x-tex\">x’</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span><span class=\"mord\">’</span></span></span></span> the matching point in the next frame. In this case we know <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>x</mi><mi mathvariant=\"normal\">’</mi></mrow><annotation encoding=\"application/x-tex\">x’</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">x</span><span class=\"mord\">’</span></span></span></span> and we solve for <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding=\"application/x-tex\">H</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span></span></span></span>. There are 6 unknowns in an affine homography so we need at least 3 matching points in order to solve this system. In addition we also have to take care of the outliers which we do using a technique called RANSAC (RAndom SAmple Consensus). The pseudo code is:</p>\n<deckgo-highlight-code   terminal=\"carbon\" theme=\"one-dark\"  highlight-lines=\"undefined\">\n          <code slot=\"code\">for n iterations\n  1. randomly pick three feature point matches\n  2. solve system to compute H\n  3. compute the number of inliers for H by projecting matches according to H and seeing whether the difference falls within some epsilon\n  4. keep H that has the most inliers\nRe-compute H using all of the inliers with the least squares estimate method\nreturn H</code>\n        </deckgo-highlight-code>\n<p>Luckily all this work is done in OpenCV with <code>cv.findHomography()</code> and <code>cv.estimateAffine2D</code> to find the full or affine homography respectively. Performing this on each frame pair’s feature matches we then get a list of n-1 homographies description the motion through each frame. </p>\n<p>To plot the trajectory I start with the point <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(1, 1, 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>, this could be any start point, and then I chain matrix multiplications of the homographies. ex:  <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>H</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∗</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>∗</mo><msub><mi>H</mi><mn>3</mn></msub><mo>∗</mo><msub><mi>H</mi><mn>2</mn></msub><mo>∗</mo><msub><mi>H</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">H_{n-1} * ... * H_3 * H_2 * H_1(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.46528em;vertical-align:0em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">x</span><span class=\"mclose\">)</span></span></span></span> my results for the first 1000 frames of my test video is depicted in the following graph. </p>\n<p><img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591340632938_motion_1000frames.png\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></p>\n<h3>Calculate Smooth Path</h3>\n<p>In honesty everything to this point is considered setup for what the core of the paper discusses which is given this existing path how do we determine the smooth path?  </p>\n<p>We know we want to replace the motion with one of three types, constant, linear, and parabolic and these can be quantified mathematically as regions of the smooth path <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">P(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">)</span></span></span></span> that have one of the following properties:</p>\n<ol>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>D</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">D(P) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> — the first derivative of the path is 0 meaning the original motion of <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span></span></span></span> was a horizontal line and 0 slope (i.e. <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">P(t) = 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">4</span></span></span></span>)</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mi>D</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">D^2(P) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> — the second derivative of the path is 0 meaning the original motion was some line with a non-zero slope (i.e. <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>4</mn><mi>x</mi><mo>+</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">P(t) = 4x + 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">4</span><span class=\"mord mathdefault\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span></span></span></span>)</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mi>D</mi><mn>3</mn></msup><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">D^3(P) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span> — the third derivative of the path is 0 meaning the original motion was parabolic-like (i.e. <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>4</mn><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">P(t) = 4x^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\">4</span><span class=\"mord\"><span class=\"mord mathdefault\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>)</li>\n</ol>\n<p>The paper forms this as an L1 minimization problem and the reason for L1 like almost every time L1 is used is because we want to take advantage of the solution space being sparse meaning the coefficients are highly significant making them either very close to 0 or very far from 0. In this application we can force the derivatives to be exactly 0. For background on L1 norms and minimization see (<a href=\"https://www.cs.colorado.edu/~srirams/courses/csci5654-fall13/regression-sli.pdf\">https://www.cs.colorado.edu/~srirams/courses/csci5654-fall13/regression-sli.pdf</a> and <a href=\"https://medium.com/mlreview/l1-norm-regularization-and-sparsity-explained-for-dummies-5b0e4be3938a\">https://medium.com/mlreview/l1-norm-regularization-and-sparsity-explained-for-dummies-5b0e4be3938a</a>)</p>\n<p>In addition to the above objective we have additional constraints: </p>\n<ol>\n<li>Inclusion Constraint - For smoothing the idea is to have a crop window that follows the smooth path within the original frames rather than warp the full frames because this leads to strange frame shapes, artifacts, and black borders around the frame so to keep a consistently sized window we are essentially moving a crop window within the frames and this contraint ensures that the warp we apply to the cropped area is within the overall frame bounds. Below is a useful visual taken from the paper:\n<img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591425723412_Screen+Shot+2020-06-05+at+11.41.55+PM.png\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></li>\n<li>Proximity Constraint - we want to preserve the movie in the way it was filmed the paper gives a great example that if the original camera was zooming our smooth path should also zoom in correctly instead of deciding that some warp should be applied to keep the same z-axis. </li>\n<li>Saliency Constraint - This I consider a extra feature that Google provides and one that I didn’t implement but the idea of which is that we want to keep the main subject within the crop window/smooth path so we want the smooth path to focus on the salient points.</li>\n</ol>\n<p>With the objective and the constraints laid out it lends itself nicely to formulate a solution via Linear Programming. The objective is: </p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>w</mi><mn>1</mn><mi mathvariant=\"normal\">∣</mi><mi>D</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><mo>+</mo><mi>w</mi><mn>2</mn><mi mathvariant=\"normal\">∣</mi><msup><mi>D</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><mo>+</mo><mi>w</mi><mn>3</mn><mi mathvariant=\"normal\">∣</mi><msup><mi>D</mi><mn>3</mn></msup><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">O(P ) = w1|D(P )| + w2|D^2(P )| + w3|D^3(P )|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">1</span><span class=\"mord\">∣</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">2</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">3</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mord\">∣</span></span></span></span></span>\n<p>where <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>w</mi><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">w1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">1</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>w</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">w2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">2</span></span></span></span>, and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>w</mi><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">w3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">3</span></span></span></span> are weights for how much we wish to favour/incorporate segments of that type. In my implementation I choose 10, 1, 100 respectively going off the results in Figure 8 of the research paper. In the results section below I also have graphs showing what I obtained when varying the weights. </p>\n<p>To minimize all of the L1 norms we use forward differencing the derivation of which for all three derivatives is very straight forward and laid out on page 3 of the paper. I want to instead focus on the implementation and more tangible side for those that may understand better by seeing code. To solve this linear programming problem in python I used a convex optimization package called cvxpy with which I experienced limitations I will go into detail with when discussing results. The full source code can be found here: <a href=\"https://github.com/thejarlid/VideoStabilizationPy\">https://github.com/thejarlid/VideoStabilizationPy</a></p>\n<deckgo-highlight-code python  terminal=\"carbon\" theme=\"one-dark\"  highlight-lines=\"\">\n          <code slot=\"code\"># weight towards constant 0 velocity path\nweight_constant = 10\n\n# weight towards segments with a non-zero velocity \nweight_linear = 1\n\n# weight towards segments with parabolic motion\nweight_parabolic =  100\n\n&quot;&quot;&quot;\nweighting of each component in the path vector we want to weight the affine portion more than the translation components\n&quot;&quot;&quot;\naffine_weights = np.transpose([1, 1, 100, 100, 100, 100])\n\n# matrix of the n smooth paths vectors that we are optimising to find \nsmooth_path = cp.Variable((n, 6))\n\n# Slack variables for constraining residual 1, 2, and 3\nslack_var_1 = cp.Variable((n, 6))     \nslack_var_2 = cp.Variable((n, 6))\nslack_var_3 = cp.Variable((n, 6))\n\nobjective = cp.Minimize(cp.sum((weight_constant * (slack_var_1 @ affine_weights)) +\n                                (weight_linear * (slack_var_2 @ affine_weights)) +\n                                (weight_parabolic * (slack_var_3 @ affine_weights)), axis=0))</code>\n        </deckgo-highlight-code>\n<p>The above lines simply create the variables I will need. smooth<em>path is a matrix of nx6 n is the number of timesteps each row is a vector of 6 variables each one corresponding to a variable in the affine transform. Each row in smooth</em>path is of the form <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo separator=\"true\">,</mo><mi>c</mi><mo separator=\"true\">,</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(tx, ty, a, b, c, d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">d</span><span class=\"mclose\">)</span></span></span></span>. this is what we want to optimize. The slack variables are used to constrain the path and the objective is defined to minimize <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mi>c</mi><mi>T</mi></msup><mi mathvariant=\"normal\">@</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">c^T @ e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\">@</span><span class=\"mord mathdefault\">e</span></span></span></span>. <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">e</span></span></span></span> being the slack variable. </p>\n<p>I next add the proximity constraints:</p>\n<deckgo-highlight-code python  terminal=\"carbon\" theme=\"one-dark\"  highlight-lines=\"\">\n          <code slot=\"code\">&quot;&quot;&quot;\nproximity constriants\nU is used to extract components from the vector smooth_path. We want to constrain\nthe values of our path vector to the following: \n0.9 &lt;= a, d &lt;= 1.1\n-0.1 &lt;= b, c &lt;= 0.1\n-0.1 &lt;= a - d &lt;= 0.1\n-0.051 &lt;= b + c &lt;= 0.05\n&quot;&quot;&quot;\n\nU = np.array([0, 0, 0, 0, 0, 0,\n              0, 0, 0, 0, 0, 0,\n              1, 0, 0, 0, 1, 0,\n              0, 1, 0, 0, 0, 1,\n              0, 0, 1, 0, 0, 1,\n              0, 0, 0, 1, -1, 0]).reshape(6, 6)\nlb = np.array([0.9, -0.1, -0.1, 0.9, -0.1, -0.05])\nub = np.array([1.1, 0.1, 0.1, 1.1, 0.1, 0.05])\nproximity = smooth_path @ U\nfor i in range(n):\n  constraints.append(proximity[i, :] &gt;= lb)\n  constraints.append(proximity[i, :] &lt;= ub)</code>\n        </deckgo-highlight-code>\n<p>To understand what is going on above its helpful to consider a single vector of smooth_path. We want the following constraints on <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">a</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">b</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">c</span></span></span></span>, and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">d</span></span></span></span> in our vector; </p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>0.9</mn><mo>≤</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>d</mi><mo>≤</mo><mn>1.1</mn></mrow><annotation encoding=\"application/x-tex\">0.9 ≤ a , d ≤ 1.1 </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">9</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">d</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">1</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi mathvariant=\"normal\">−</mi><mn>0.1</mn><mo>≤</mo><mi>b</mi><mo separator=\"true\">,</mo><mi>c</mi><mo>≤</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">−0.1 ≤ b, c ≤ 0.1 </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">c</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi mathvariant=\"normal\">−</mi><mn>0.05</mn><mo>≤</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo>≤</mo><mn>0.05</mn></mrow><annotation encoding=\"application/x-tex\">−0.05 ≤ b +c ≤ 0.05 </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">c</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">5</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi mathvariant=\"normal\">−</mi><mn>0.1</mn><mo>≤</mo><mi>a</mi><mi mathvariant=\"normal\">−</mi><mi>d</mi><mo>≤</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">−0.1 ≤ a − d ≤ 0.1 </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.83041em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mord\">−</span><span class=\"mord mathdefault\">d</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span></span></span></span></span>\n<p>When the vector <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">p</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">)</span></span></span></span> of the form <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>t</mi><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mi>y</mi><mo separator=\"true\">,</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo separator=\"true\">,</mo><mi>c</mi><mo separator=\"true\">,</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(tx, ty, a, b, c, d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">d</span><span class=\"mclose\">)</span></span></span></span> is multiplied by <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">U</span></span></span></span> the first column in <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding=\"application/x-tex\">U</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">U</span></span></span></span> extracts <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">a</span></span></span></span>, the second extracts <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">b</span></span></span></span>, the third extracts, <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">c</span></span></span></span>, the fourth extracts <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">d</span></span></span></span>, the fifth column gives us <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>a</mi><mo>−</mo><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">a - d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">d</span></span></span></span>, and the sixth column gives us <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>b</mi><mo>+</mo><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">b + c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">c</span></span></span></span> so our resulting vector is of the form <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo separator=\"true\">,</mo><mi>c</mi><mo separator=\"true\">,</mo><mi>d</mi><mo separator=\"true\">,</mo><mi>a</mi><mo>−</mo><mi>d</mi><mo separator=\"true\">,</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(a, b, c, d, a - d, b + c)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">d</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">d</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">c</span><span class=\"mclose\">)</span></span></span></span> we then compare elementwise to lb and ub. Looking at the first element this comparison/constraint performs <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>0.9</mn><mo>≤</mo><mi>a</mi><mo>≤</mo><mn>1.1</mn></mrow><annotation encoding=\"application/x-tex\">0.9 ≤ a  ≤ 1.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.78041em;vertical-align:-0.13597em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">9</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719400000000001em;vertical-align:-0.13597em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">1</span></span></span></span>. The idea translates to all elements in the proximity vector, lb, and ub. </p>\n<p>After the proximity constraints I add the inclusion constraints to ensure the smooth transform will keep the crop window within the frame bounds. Since we are working with a fixed crop ratio we take new corner points at (1-crop<em>ratio) within from the real corner points, project them according to the smooth</em>path and declare that whatever the x and y of these new corners become make sure that they are at least greater than or equal to 0 and within the width and height of the frame. </p>\n<deckgo-highlight-code python  terminal=\"carbon\" theme=\"one-dark\"  highlight-lines=\"\">\n          <code slot=\"code\"># inclusion constraints for the crop corners\n# want to make sure the corner points when projected are within the frame dimensions\n\ncorners = get_corner_crop_pts(frame_dimensions)\nfor corner in corners:\n  x, y = corner\n\n  # x&#39; = tx + ax + by\n  projected_x = smooth_path @ np.transpose([1, 0, x, y, 0, 0])\n\n  # y&#39; = ty + cx + dy\n  projected_y = smooth_path @ np.transpose([0, 1, 0, 0, x, y])\n\n  constraints.append(projected_x &gt;= 0)\n  constraints.append(projected_y &gt;= 0)\n  constraints.append(projected_x &lt;= frame_dimensions[1])\n  constraints.append(projected_y &lt;= frame_dimensions[0])</code>\n        </deckgo-highlight-code>\n<p>Finally the smoothness constraints:</p>\n<deckgo-highlight-code python  terminal=\"carbon\" theme=\"one-dark\"  highlight-lines=\"\">\n          <code slot=\"code\"># Smoothness constraints\nconstraints.append(slack_var_1 &gt;= 0)\nconstraints.append(slack_var_2 &gt;= 0)\nconstraints.append(slack_var_3 &gt;= 0)\n\nfor i in range(n - 3):\n  # Extract smooth path component variables into a matrix we can then use to calculate each residual\n\n  # Residual 1 is for the constant zero velocity path\n  # Residual 2 is for the constant non-zero velocity path\n  # Residual 3 is for the parabolic non zero acceleration path\n  B_t = np.array([smooth_path[i, 2], smooth_path[i, 4], 0, \n                  smooth_path[i, 3], smooth_path[i, 5], 0, \n                  smooth_path[i, 0], smooth_path[i, 1], 1]).reshape((3,3))\n  B_t1 = np.array([smooth_path[i+1, 2], smooth_path[i+1, 4], 0, \n                    smooth_path[i+1, 3], smooth_path[i+1, 5], 0, \n                    smooth_path[i+1, 0], smooth_path[i+1, 1], 1]).reshape((3,3))\n  B_t2 = np.array([smooth_path[i+2, 2], smooth_path[i+2, 4], 0, \n                    smooth_path[i+2, 3], smooth_path[i+2, 5], 0, \n                    smooth_path[i+2, 0], smooth_path[i+2, 1], 1]).reshape((3,3))\n  B_t3 = np.array([smooth_path[i+3, 2], smooth_path[i+3, 4], 0, \n                    smooth_path[i+3, 3], smooth_path[i+3, 5], 0, \n                    smooth_path[i+3, 0], smooth_path[i+3, 1], 1]).reshape((3,3))\n\n  residual_t = np.transpose(timewise_homographies[i + 1]) @ B_t1  - B_t\n  residual_t1 = np.transpose(timewise_homographies[i + 2]) @ B_t2 - B_t1\n  residual_t2 = np.transpose(timewise_homographies[i + 3]) @ B_t3 - B_t2\n\n  residual_t = np.array([residual_t[2, 0], residual_t[2, 1], residual_t[0, 0], \n                        residual_t[1, 0], residual_t[0, 1], residual_t[1, 1]])\n  residual_t1 = np.array([residual_t1[2, 0], residual_t1[2, 1], residual_t1[0, 0], \n                          residual_t1[1, 0], residual_t1[0, 1], residual_t1[1, 1]])\n  residual_t2 = np.array([residual_t2[2, 0], residual_t2[2, 1], residual_t2[0, 0], \n                          residual_t2[1, 0], residual_t2[0, 1], residual_t2[1, 1]])\n\n  # this is where the actual smoothness constraint is obtained from the residuals\n  # i.e. this is where we summarized the following:\n  #  -e_t1 &lt;= R_t(p) &lt; e_t1\n  #  -e_t2 &lt;= R_t1(p) - R_t(p) &lt; e_t2\n  #  -e_t3 &lt;= R_t2(p) - 2R_t1(p) + R_t(p) &lt; e_t3\n  # if we can vectorize the below constraints we can speed this up and most likely get better results\n  # being able to smooth over more frames\n  for j in range(6):\n    constraints.append(residual_t[j] &lt;= slack_var_1[i, j])\n    constraints.append(residual_t[j] &gt;= -slack_var_1[i, j])\n    constraints.append((residual_t1[j] - residual_t[j]) &lt;= slack_var_2[i, j])\n    constraints.append((residual_t1[j] - residual_t[j]) &gt;= -slack_var_2[i, j])\n    constraints.append((residual_t2[j] - 2*residual_t1[j] + residual_t[j]) &lt;= slack_var_3[i, j])\n    constraints.append((residual_t2[j] - 2*residual_t1[j] + residual_t[j]) &gt;= -slack_var_3[i, j])\n    \nfor i in range(n-3, n):\n  constraints.append(smooth_path[i, 5] == smooth_path[n-1, 5])</code>\n        </deckgo-highlight-code>\n<p>I tried to document the code above with comments describing what is going on and for the large part it correlates directly to the residual derivation in the paper. To reiterate the major chunks we first create <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">B_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">B_t1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">1</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">B_t2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">2</span></span></span></span>, and  <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">B_t3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">3</span></span></span></span> for the current time step by extracting the smooth_path vector at time t into a matrix of the form </p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo fence=\"true\">∣</mo><mtable rowspacing=\"0.15999999999999992em\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>c</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>b</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>d</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>t</mi><mi>x</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>t</mi><mi>y</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">∣</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{vmatrix}\na &amp; c &amp; 0\\\\\nb &amp; d &amp; 0\\\\\ntx &amp; ty &amp; 1\n\\end{vmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.636em;vertical-align:-1.5500299999999998em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.08597em;\"><span style=\"top:-1.05597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-1.6619700000000002em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.26797em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.87397em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.47997em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-4.08597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500299999999998em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">a</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">b</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">c</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">d</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.05em;\"><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-3.0099999999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-1.8099999999999994em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500000000000007em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.08597em;\"><span style=\"top:-1.05597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-1.6619700000000002em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.26797em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-2.87397em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-3.47997em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span><span style=\"top:-4.08597em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5500299999999998em;\"><span></span></span></span></span></span></span></span></span></span></span></span>\n<p>This is just an affine homography transposed and we then use these to form our three residuals. We then add the appropriate constraints on the residuals according to the paper and these comments:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>−</mo><msub><mi>e</mi><mi>t</mi></msub><mn>1</mn><mo>&lt;</mo><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><msub><mi>e</mi><mi>t</mi></msub><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">-e_t1 &lt;= R_t(p) &lt; e_t1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.79444em;vertical-align:-0.15em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathdefault\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.79444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">1</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>−</mo><msub><mi>e</mi><mi>t</mi></msub><mn>2</mn><mo>&lt;</mo><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mn>1</mn><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><msub><mi>e</mi><mi>t</mi></msub><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">-e_t2 &lt;= R_t1(p) - R_t(p) &lt; e_t2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.79444em;vertical-align:-0.15em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathdefault\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.79444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">2</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>−</mo><msub><mi>e</mi><mi>t</mi></msub><mn>3</mn><mo>&lt;</mo><mo>=</mo><msub><mi>R</mi><mi>t</mi></msub><mn>2</mn><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mn>2</mn><msub><mi>R</mi><mi>t</mi></msub><mn>1</mn><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mi>R</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><msub><mi>e</mi><mi>t</mi></msub><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">-e_t3 &lt;= R_t2(p) - 2R_t1(p) + R_t(p) &lt; e_t3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.79444em;vertical-align:-0.15em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathdefault\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">2</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">1</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.79444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">3</span></span></span></span></span>\n<p>The issue is that we do this element wise manually instead of in vectorized format leading to some issues. I want to say this is because of my inexperience with the package rather than an inherent limitation on the python language and cvxpy in general. If anyone does know how I can vectorize or improve this smoothness constraint I would love to know. I spent a long time trying to vectorize and use slices. </p>\n<p>In code the final steps is to just let the convex optimization package solve this for us and upon completion the smooth<em>path variable will be populated. A final bit of post processing is to take each of the n smooth</em>path vectors and turn them into n affine homographies and return them in a list.  </p>\n<h3>Produce new ‘smooth’ frames</h3>\n<p>Now that the hard work above is over we can produce new frames. To do so is quite simple take the corners of the crop window centred at the middle of the original frame and warp it according to the smooth path homography we found at the associated time step. The final step is since in our final frame we want the top left corner to correspond to <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(0, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>, the top right to correspond to <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(0, w)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">)</span></span></span></span>, bottom left to <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(h, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>, and bottom right to <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>h</mi><mo separator=\"true\">,</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(h, w)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">)</span></span></span></span> we find our final homography by just saying project this warped crop window now into a straight window and produce a final frame.</p>\n<h2>Results and improvements</h2>\n<p>Given that my goal was to revisit the problem to better understand the paper that in itself is a result to me. Along the way I got to revisit my passion for CV, dive deeper into the mathematics behind homographies, and expose myself to field of linear and convex optimizations and linear programming. </p>\n<p>This time around the results I produced were more stable than before here is a gif of a short segment the left being the original and the right being my produced frames.</p>\n<p><img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591429800559_ezgif-6-95b7732f1bb5.gif\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></p>\n<p>Its clear to see that the cropped one has far less motion, the orientation is off and this is because I wasn’t able to smooth over the entire video I had to work with small segments of ~150-300 frames because when the convex optimization package would compile my constraints it would take upwards of hours as more and more frames were added and occasionally memory limits would get hit. I have a feeling if I were able to figure out vectorized formats for the smoothing constraint compilation of the constraints would be faster. In addition, if I could smooth over thousands of frames the orientation would be fixed as it would pick the best that would blend with minimal motions for later frames. </p>\n<p>I also plot the x and y motion before and after smoothing to view the results for various segments that took advantage of different motion models. Below are the results with green representing the smoothed motion. </p>\n<p><img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591430248432_motion_0_150.png\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></p>\n<p><img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591430248457_motion_300_600.png\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></p>\n<p>Finally I also wanted to test changes in weight and see what would happen if I only wanted parabolic motion and the resulting graph comes from w1 = w2 = 0, w3 = 100. </p>\n<p><img src=\"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591430248479_motion_parabolic.png\" class=\"gatsby-img-attributes\" style=\"width: 100%;\" alt=\"null\"  /></p>\n<p>All in all I think the methods in this paper are really really interesting, the thing about computer vision is that you get extremely tangible results. Below are just a collection of different video segments that were smoothed. </p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Since my junior year of college I’ve been in love with the field of Computer Vision and low level image processing. While working on my final project for the class I came across this paper, "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Auto-Directed Video Stabilization with Robust L1 Optimal Camera Paths,"}]},{"type":"text","value":" from Google ("},{"type":"element","tagName":"a","properties":{"href":"https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/37041.pdf"},"children":[{"type":"text","value":"https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/37041.pdf"}]},{"type":"text","value":"). With the quarantine I finally had time to revisit the paper and thoroughly read it. In this post I want to try to summarize my learnings and present the ideas in a more bitesized layman's term format. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Background"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Throughout the Computer Vision class, the assignments had us build up an image processing library in C++ notably including edge/feature detection, optical flow,  and panorama stitching. Our final project was open ended and I chose to implement video stabilization using many of the previous assignments as building blocks. It was while researching existing methods that I came across the paper from Google. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"However, having decided to attack the problem with two days till the deadline, as every college student does, I read the paper quite fast glancing over the details and focused on trying to pull out the major ideas. To be absolutely honest once I got to the section on Linear Programming the details largely flew over my head, but I was able to gather three major steps:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Estimate Original Path"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Calculate smooth path"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Warp each frame to the new path "}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I was on the right track with the first and third step in my initial implementation. I used my Harris corner detector to find feature points in each frame and using code for panorama stitching I extracted feature matches between frames using RANSAC to keep inliers. With the matches I then calculated a homography between each frame pair to describe the motion of pixels. Where my implementation differed was on the second step; having homographies "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"…"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"n"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"H_1, H_2, …, H_{n-1}"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.891661em;vertical-align:-0.208331em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.30110799999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.30110799999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"2"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["minner"]},"children":[{"type":"text","value":"…"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.301108em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"n"}]},{"type":"element","tagName":"span","properties":{"className":["mbin","mtight"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.208331em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]},{"type":"text","value":" I had an estimated camera trajectory for n frames and my idea was that for each homography I would replace it with a new homography computed as the gaussian average over a window of neighboring homographies. I would then use this new series of homographies as the smooth path and fill in frames by using using the inverse matrix of each homography and bilinear interpolation to projecting backwards and fill in each pixel value. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"My hypothesis was that the larger the window the more prior and preceding information homographies at each time step would have and the smoother the resulting curve would be. The implementation worked in the sense that I could form a new video but the results were far from desirable. The result was that high frequency and jarring jitter was suppressed rather than eliminated and in reality the overall videos were not much of an improvement. Some segments did see improvements, but the lack of consistency acted as a counterweight making it more difficult to watch. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you’re interested in the image processing library and the code behind this implementation  you can see it here: "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/thejarlid/ImgLib_VideoStabilization"},"children":[{"type":"text","value":"https://github.com/thejarlid/ImgLib_VideoStabilization"}]},{"type":"text","value":" "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Diving into the paper and reimplementation"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The high level idea in the paper is to replace ‘handheld’-like footage with motion that mimics professional cinematography techniques. Taking original motion of the camera the method aims to fit segments with either constant, linear, or parabolic trajectories. This graph from the paper helps to visualize the objective. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591310002620_Screen+Shot+2020-06-04+at+3.23.45+PM.png","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Like in my initial implementation there are three distinct phases of the video stabilization pipeline presented in the paper and I’ll go through each one independently below."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Estimate Original Path"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Like any problem, the first step is to understand what we are trying to solve and in this case that comes in the form of the original camera motion. The motion of the camera is defined as the sequence of homographies between each frame for n frames we will have (n-1) homographies; "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"…"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"n"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"H_1, H_2, …, H_{n-1}"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.891661em;vertical-align:-0.208331em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.30110799999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.30110799999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"2"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["minner"]},"children":[{"type":"text","value":"…"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.301108em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"n"}]},{"type":"element","tagName":"span","properties":{"className":["mbin","mtight"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.208331em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]},{"type":"text","value":". In the paper and my implementation we use an affine homography which is a special case of a homography of the form: "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"fence":"true"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mtable","properties":{"rowspacing":"0.15999999999999992em","columnspacing":"1em"},"children":[{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]}]}]}]}]},{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"y"}]}]}]}]}]},{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"mo","properties":{"fence":"true"},"children":[{"type":"text","value":"∣"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":" \\begin{vmatrix}\na & b & tx\\\\\nc & d & ty\\\\\n0 & 0 & 1\n\\end{vmatrix}"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:3.636em;vertical-align:-1.5500299999999998em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["minner"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"element","tagName":"span","properties":{"className":["delimsizing","mult"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-1.05597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.6619700000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.26797em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.87397em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.47997em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-4.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500299999999998em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtable"]},"children":[{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"y"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"element","tagName":"span","properties":{"className":["delimsizing","mult"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-1.05597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.6619700000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.26797em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.87397em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.47997em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-4.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500299999999998em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The affine transform has 6 degrees of freedom as opposed to 8 degrees available with the general homography and also preserves parallelism in its warps. If you’re interested in the details behind homographies I recommend going through the slides here: ("},{"type":"element","tagName":"a","properties":{"href":"https://docs.google.com/presentation/d/1V_8vwkIAEOuDAXZyJCBCplbst1A2to2JsoBSteVZYZ4/edit#slide=id.g3813390b8a_0_48"},"children":[{"type":"text","value":"https://docs.google.com/presentation/d/1V_8vwkIAEOuDAXZyJCBCplbst1A2to2JsoBSteVZYZ4/edit#slide=id.g3813390b8a_0_48"}]},{"type":"text","value":"). "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To find the motion between a pair of subsequent frames we begin by detecting feature points in each frame and then trying to match the corresponding feature points. Feature point detection is a whole subspace within image processing and computer vision an incredibly interesting one too that I recommend taking a dive into. As opposed to the Harris Corner Detector used in my initial implementation I opted for ORB since it was open source, fast, and more robust. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Once feature points are extracted from all frames we can attempt to match these feature between subsequent frame pairs. The computation to determine a match differs between detection algorithms because of the way each chooses to describe a feature and so I won’t go into it here. Another important point is that it’s common for the a match to be wrong. Below are some of the matches I extracted between frames and you can see while in the first pair the matches mostly consistent whereas in the second there are a few outliers. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591335922876_matches_541-542.jpg","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591335939318_matches_717-718.jpg","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With the matches we can now solve for the homography between the two frames. The computation comes down to a system of equations. Remember the form for a homography is "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"fence":"true"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mtable","properties":{"rowspacing":"0.15999999999999992em","columnspacing":"1em"},"children":[{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]}]}]}]}]},{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"y"}]}]}]}]}]},{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"mo","properties":{"fence":"true"},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":" H = \\begin{vmatrix}\na & b & tx\\\\\nc & d & ty\\\\\n0 & 0 & 1\n\\end{vmatrix}"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:3.636em;vertical-align:-1.5500299999999998em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["minner"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"element","tagName":"span","properties":{"className":["delimsizing","mult"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-1.05597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.6619700000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.26797em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.87397em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.47997em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-4.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500299999999998em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtable"]},"children":[{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"y"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"element","tagName":"span","properties":{"className":["delimsizing","mult"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-1.05597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.6619700000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.26797em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.87397em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.47997em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-4.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500299999999998em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"’"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"Hx = x’"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.69444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"’"}]}]}]}]},{"type":"text","value":" s.t "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"text","value":" is a homogenous coordinate vector "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"fence":"true"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mtable","properties":{"rowspacing":"0.15999999999999992em","columnspacing":"1em"},"children":[{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"y"}]}]}]}]},{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"mo","properties":{"fence":"true"},"children":[{"type":"text","value":"∣"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"\\begin{vmatrix} x \\\\ y \\\\ 1 \\end{vmatrix}"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:3.636em;vertical-align:-1.5500299999999998em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["minner"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"element","tagName":"span","properties":{"className":["delimsizing","mult"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-1.05597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.6619700000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.26797em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.87397em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.47997em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-4.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500299999999998em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtable"]},"children":[{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"y"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"element","tagName":"span","properties":{"className":["delimsizing","mult"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-1.05597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.6619700000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.26797em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.87397em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.47997em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-4.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500299999999998em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]}]},{"type":"text","value":" "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"When you take "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"H"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]}]}]}]},{"type":"text","value":" and multiply it by a homogenous co-ordinate "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"text","value":" we would hope to obtain "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"’"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x’"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.69444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"’"}]}]}]}]},{"type":"text","value":" the matching point in the next frame. In this case we know "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"text","value":" and "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"’"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"x’"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.69444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"’"}]}]}]}]},{"type":"text","value":" and we solve for "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"H"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]}]}]}]},{"type":"text","value":". There are 6 unknowns in an affine homography so we need at least 3 matching points in order to solve this system. In addition we also have to take care of the outliers which we do using a technique called RANSAC (RAndom SAmple Consensus). The pseudo code is:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"terminal":"carbon","theme":"one-dark","highlight-lines":"undefined"},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"for n iterations\n  1. randomly pick three feature point matches\n  2. solve system to compute H\n  3. compute the number of inliers for H by projecting matches according to H and seeing whether the difference falls within some epsilon\n  4. keep H that has the most inliers\nRe-compute H using all of the inliers with the least squares estimate method\nreturn H"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Luckily all this work is done in OpenCV with "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"cv.findHomography()"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"cv.estimateAffine2D"}]},{"type":"text","value":" to find the full or affine homography respectively. Performing this on each frame pair’s feature matches we then get a list of n-1 homographies description the motion through each frame. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To plot the trajectory I start with the point "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"(1, 1, 1)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":", this could be any start point, and then I chain matrix multiplications of the homographies. ex:  "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"n"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"∗"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"∗"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"∗"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"∗"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"H_{n-1} * ... * H_3 * H_2 * H_1(x)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.891661em;vertical-align:-0.208331em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.301108em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"n"}]},{"type":"element","tagName":"span","properties":{"className":["mbin","mtight"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.208331em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"∗"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.46528em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"∗"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.83333em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.30110799999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"3"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"∗"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.83333em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.30110799999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"2"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"∗"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.08125em;"},"children":[{"type":"text","value":"H"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.30110799999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" my results for the first 1000 frames of my test video is depicted in the following graph. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591340632938_motion_1000frames.png","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Calculate Smooth Path"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In honesty everything to this point is considered setup for what the core of the paper discusses which is given this existing path how do we determine the smooth path?  "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We know we want to replace the motion with one of three types, constant, linear, and parabolic and these can be quantified mathematically as regions of the smooth path "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"P(t)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" that have one of the following properties:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"D(P) = 0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"text","value":" — the first derivative of the path is 0 meaning the original motion of "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"P"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]}]}]}]},{"type":"text","value":" was a horizontal line and 0 slope (i.e. "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"4"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"P(t) = 4"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"4"}]}]}]}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"D^2(P) = 0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.064108em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8141079999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.063em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"2"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"text","value":" — the second derivative of the path is 0 meaning the original motion was some line with a non-zero slope (i.e. "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"4"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"5"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"P(t) = 4x + 5"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.72777em;vertical-align:-0.08333em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"4"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"5"}]}]}]}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"D^3(P) = 0"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.064108em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8141079999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.063em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"3"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"text","value":" — the third derivative of the path is 0 meaning the original motion was parabolic-like (i.e. "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"4"}]},{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"P(t) = 4x^2"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.8141079999999999em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"4"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8141079999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.063em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"2"}]}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The paper forms this as an L1 minimization problem and the reason for L1 like almost every time L1 is used is because we want to take advantage of the solution space being sparse meaning the coefficients are highly significant making them either very close to 0 or very far from 0. In this application we can force the derivatives to be exactly 0. For background on L1 norms and minimization see ("},{"type":"element","tagName":"a","properties":{"href":"https://www.cs.colorado.edu/~srirams/courses/csci5654-fall13/regression-sli.pdf"},"children":[{"type":"text","value":"https://www.cs.colorado.edu/~srirams/courses/csci5654-fall13/regression-sli.pdf"}]},{"type":"text","value":" and "},{"type":"element","tagName":"a","properties":{"href":"https://medium.com/mlreview/l1-norm-regularization-and-sparsity-explained-for-dummies-5b0e4be3938a"},"children":[{"type":"text","value":"https://medium.com/mlreview/l1-norm-regularization-and-sparsity-explained-for-dummies-5b0e4be3938a"}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In addition to the above objective we have additional constraints: "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Inclusion Constraint - For smoothing the idea is to have a crop window that follows the smooth path within the original frames rather than warp the full frames because this leads to strange frame shapes, artifacts, and black borders around the frame so to keep a consistently sized window we are essentially moving a crop window within the frames and this contraint ensures that the warp we apply to the cropped area is within the overall frame bounds. Below is a useful visual taken from the paper:\n"},{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591425723412_Screen+Shot+2020-06-05+at+11.41.55+PM.png","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Proximity Constraint - we want to preserve the movie in the way it was filmed the paper gives a great example that if the original camera was zooming our smooth path should also zoom in correctly instead of deciding that some warp should be applied to keep the same z-axis. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Saliency Constraint - This I consider a extra feature that Google provides and one that I didn’t implement but the idea of which is that we want to keep the main subject within the crop window/smooth path so we want the smooth path to focus on the salient points."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With the objective and the constraints laid out it lends itself nicely to formulate a solution via Linear Programming. The objective is: "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"∣"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"O(P ) = w1|D(P )| + w2|D^2(P )| + w3|D^3(P )|"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"O"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02691em;"},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.1141079999999999em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02691em;"},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8641079999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.113em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"2"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1.1141079999999999em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02691em;"},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02778em;"},"children":[{"type":"text","value":"D"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8641079999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.113em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mtight"]},"children":[{"type":"text","value":"3"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"P"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"∣"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"where "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"w1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02691em;"},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"text","value":", "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"w2"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02691em;"},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"2"}]}]}]}]},{"type":"text","value":", and "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"w3"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02691em;"},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"3"}]}]}]}]},{"type":"text","value":" are weights for how much we wish to favour/incorporate segments of that type. In my implementation I choose 10, 1, 100 respectively going off the results in Figure 8 of the research paper. In the results section below I also have graphs showing what I obtained when varying the weights. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To minimize all of the L1 norms we use forward differencing the derivation of which for all three derivatives is very straight forward and laid out on page 3 of the paper. I want to instead focus on the implementation and more tangible side for those that may understand better by seeing code. To solve this linear programming problem in python I used a convex optimization package called cvxpy with which I experienced limitations I will go into detail with when discussing results. The full source code can be found here: "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/thejarlid/VideoStabilizationPy"},"children":[{"type":"text","value":"https://github.com/thejarlid/VideoStabilizationPy"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"python":"","terminal":"carbon","theme":"one-dark","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"# weight towards constant 0 velocity path\nweight_constant = 10\n\n# weight towards segments with a non-zero velocity \nweight_linear = 1\n\n# weight towards segments with parabolic motion\nweight_parabolic =  100\n\n\"\"\"\nweighting of each component in the path vector we want to weight the affine portion more than the translation components\n\"\"\"\naffine_weights = np.transpose([1, 1, 100, 100, 100, 100])\n\n# matrix of the n smooth paths vectors that we are optimising to find \nsmooth_path = cp.Variable((n, 6))\n\n# Slack variables for constraining residual 1, 2, and 3\nslack_var_1 = cp.Variable((n, 6))     \nslack_var_2 = cp.Variable((n, 6))\nslack_var_3 = cp.Variable((n, 6))\n\nobjective = cp.Minimize(cp.sum((weight_constant * (slack_var_1 @ affine_weights)) +\n                                (weight_linear * (slack_var_2 @ affine_weights)) +\n                                (weight_parabolic * (slack_var_3 @ affine_weights)), axis=0))"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The above lines simply create the variables I will need. smooth"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"path is a matrix of nx6 n is the number of timesteps each row is a vector of 6 variables each one corresponding to a variable in the affine transform. Each row in smooth"}]},{"type":"text","value":"path is of the form "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"y"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"(tx, ty, a, b, c, d)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"y"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":". this is what we want to optimize. The slack variables are used to constrain the path and the objective is defined to minimize "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msup","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"T"}]}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"@"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"c^T @ e"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.8413309999999999em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.8413309999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-3.063em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"],"style":"margin-right:0.13889em;"},"children":[{"type":"text","value":"T"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"@"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"e"}]}]}]}]},{"type":"text","value":". "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"e"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"e"}]}]}]}]},{"type":"text","value":" being the slack variable. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I next add the proximity constraints:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"python":"","terminal":"carbon","theme":"one-dark","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"\"\"\"\nproximity constriants\nU is used to extract components from the vector smooth_path. We want to constrain\nthe values of our path vector to the following: \n0.9 <= a, d <= 1.1\n-0.1 <= b, c <= 0.1\n-0.1 <= a - d <= 0.1\n-0.051 <= b + c <= 0.05\n\"\"\"\n\nU = np.array([0, 0, 0, 0, 0, 0,\n              0, 0, 0, 0, 0, 0,\n              1, 0, 0, 0, 1, 0,\n              0, 1, 0, 0, 0, 1,\n              0, 0, 1, 0, 0, 1,\n              0, 0, 0, 1, -1, 0]).reshape(6, 6)\nlb = np.array([0.9, -0.1, -0.1, 0.9, -0.1, -0.05])\nub = np.array([1.1, 0.1, 0.1, 1.1, 0.1, 0.05])\nproximity = smooth_path @ U\nfor i in range(n):\n  constraints.append(proximity[i, :] >= lb)\n  constraints.append(proximity[i, :] <= ub)"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To understand what is going on above its helpful to consider a single vector of smooth_path. We want the following constraints on "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"a"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]}]}]}]},{"type":"text","value":", "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"b"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.69444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]}]}]}]},{"type":"text","value":", "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"c"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]}]}]}]},{"type":"text","value":", and "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"d"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.69444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]}]}]}]},{"type":"text","value":" in our vector; "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0.9"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1.1"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"0.9 ≤ a , d ≤ 1.1 "}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.78041em;vertical-align:-0.13597em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"9"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.8888799999999999em;vertical-align:-0.19444em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0.1"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0.1"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"−0.1 ≤ b, c ≤ 0.1 "}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.78041em;vertical-align:-0.13597em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.8888799999999999em;vertical-align:-0.19444em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0.05"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0.05"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"−0.05 ≤ b +c ≤ 0.05 "}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.78041em;vertical-align:-0.13597em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"5"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.77777em;vertical-align:-0.08333em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.7719400000000001em;vertical-align:-0.13597em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"5"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0.1"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"mi","properties":{"mathvariant":"normal"},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0.1"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"−0.1 ≤ a − d ≤ 0.1 "}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.78041em;vertical-align:-0.13597em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.83041em;vertical-align:-0.13597em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"When the vector "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"p(t)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" of the form "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"y"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"(tx, ty, a, b, c, d)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"y"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" is multiplied by "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"U"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"U"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"U"}]}]}]}]},{"type":"text","value":" the first column in "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"U"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"U"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.68333em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.10903em;"},"children":[{"type":"text","value":"U"}]}]}]}]},{"type":"text","value":" extracts "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"a"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]}]}]}]},{"type":"text","value":", the second extracts "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"b"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.69444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]}]}]}]},{"type":"text","value":", the third extracts, "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"c"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]}]}]}]},{"type":"text","value":", the fourth extracts "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"d"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.69444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]}]}]}]},{"type":"text","value":", the fifth column gives us "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"a - d"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.66666em;vertical-align:-0.08333em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.69444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]}]}]}]},{"type":"text","value":", and the sixth column gives us "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"b + c"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.77777em;vertical-align:-0.08333em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.43056em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]}]}]}]},{"type":"text","value":" so our resulting vector is of the form "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"(a, b, c, d, a - d, b + c)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.8888799999999999em;vertical-align:-0.19444em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" we then compare elementwise to lb and ub. Looking at the first element this comparison/constraint performs "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0.9"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1.1"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"0.9 ≤ a  ≤ 1.1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.78041em;vertical-align:-0.13597em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"9"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.7719400000000001em;vertical-align:-0.13597em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"≤"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.64444em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"text","value":". The idea translates to all elements in the proximity vector, lb, and ub. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"After the proximity constraints I add the inclusion constraints to ensure the smooth transform will keep the crop window within the frame bounds. Since we are working with a fixed crop ratio we take new corner points at (1-crop"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"ratio) within from the real corner points, project them according to the smooth"}]},{"type":"text","value":"path and declare that whatever the x and y of these new corners become make sure that they are at least greater than or equal to 0 and within the width and height of the frame. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"python":"","terminal":"carbon","theme":"one-dark","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"# inclusion constraints for the crop corners\n# want to make sure the corner points when projected are within the frame dimensions\n\ncorners = get_corner_crop_pts(frame_dimensions)\nfor corner in corners:\n  x, y = corner\n\n  # x' = tx + ax + by\n  projected_x = smooth_path @ np.transpose([1, 0, x, y, 0, 0])\n\n  # y' = ty + cx + dy\n  projected_y = smooth_path @ np.transpose([0, 1, 0, 0, x, y])\n\n  constraints.append(projected_x >= 0)\n  constraints.append(projected_y >= 0)\n  constraints.append(projected_x <= frame_dimensions[1])\n  constraints.append(projected_y <= frame_dimensions[0])"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Finally the smoothness constraints:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"deckgo-highlight-code","properties":{"python":"","terminal":"carbon","theme":"one-dark","highlight-lines":""},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"code","properties":{"slot":"code"},"children":[{"type":"text","value":"# Smoothness constraints\nconstraints.append(slack_var_1 >= 0)\nconstraints.append(slack_var_2 >= 0)\nconstraints.append(slack_var_3 >= 0)\n\nfor i in range(n - 3):\n  # Extract smooth path component variables into a matrix we can then use to calculate each residual\n\n  # Residual 1 is for the constant zero velocity path\n  # Residual 2 is for the constant non-zero velocity path\n  # Residual 3 is for the parabolic non zero acceleration path\n  B_t = np.array([smooth_path[i, 2], smooth_path[i, 4], 0, \n                  smooth_path[i, 3], smooth_path[i, 5], 0, \n                  smooth_path[i, 0], smooth_path[i, 1], 1]).reshape((3,3))\n  B_t1 = np.array([smooth_path[i+1, 2], smooth_path[i+1, 4], 0, \n                    smooth_path[i+1, 3], smooth_path[i+1, 5], 0, \n                    smooth_path[i+1, 0], smooth_path[i+1, 1], 1]).reshape((3,3))\n  B_t2 = np.array([smooth_path[i+2, 2], smooth_path[i+2, 4], 0, \n                    smooth_path[i+2, 3], smooth_path[i+2, 5], 0, \n                    smooth_path[i+2, 0], smooth_path[i+2, 1], 1]).reshape((3,3))\n  B_t3 = np.array([smooth_path[i+3, 2], smooth_path[i+3, 4], 0, \n                    smooth_path[i+3, 3], smooth_path[i+3, 5], 0, \n                    smooth_path[i+3, 0], smooth_path[i+3, 1], 1]).reshape((3,3))\n\n  residual_t = np.transpose(timewise_homographies[i + 1]) @ B_t1  - B_t\n  residual_t1 = np.transpose(timewise_homographies[i + 2]) @ B_t2 - B_t1\n  residual_t2 = np.transpose(timewise_homographies[i + 3]) @ B_t3 - B_t2\n\n  residual_t = np.array([residual_t[2, 0], residual_t[2, 1], residual_t[0, 0], \n                        residual_t[1, 0], residual_t[0, 1], residual_t[1, 1]])\n  residual_t1 = np.array([residual_t1[2, 0], residual_t1[2, 1], residual_t1[0, 0], \n                          residual_t1[1, 0], residual_t1[0, 1], residual_t1[1, 1]])\n  residual_t2 = np.array([residual_t2[2, 0], residual_t2[2, 1], residual_t2[0, 0], \n                          residual_t2[1, 0], residual_t2[0, 1], residual_t2[1, 1]])\n\n  # this is where the actual smoothness constraint is obtained from the residuals\n  # i.e. this is where we summarized the following:\n  #  -e_t1 <= R_t(p) < e_t1\n  #  -e_t2 <= R_t1(p) - R_t(p) < e_t2\n  #  -e_t3 <= R_t2(p) - 2R_t1(p) + R_t(p) < e_t3\n  # if we can vectorize the below constraints we can speed this up and most likely get better results\n  # being able to smooth over more frames\n  for j in range(6):\n    constraints.append(residual_t[j] <= slack_var_1[i, j])\n    constraints.append(residual_t[j] >= -slack_var_1[i, j])\n    constraints.append((residual_t1[j] - residual_t[j]) <= slack_var_2[i, j])\n    constraints.append((residual_t1[j] - residual_t[j]) >= -slack_var_2[i, j])\n    constraints.append((residual_t2[j] - 2*residual_t1[j] + residual_t[j]) <= slack_var_3[i, j])\n    constraints.append((residual_t2[j] - 2*residual_t1[j] + residual_t[j]) >= -slack_var_3[i, j])\n    \nfor i in range(n-3, n):\n  constraints.append(smooth_path[i, 5] == smooth_path[n-1, 5])"}]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I tried to document the code above with comments describing what is going on and for the large part it correlates directly to the residual derivation in the paper. To reiterate the major chunks we first create "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"B"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"B_t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.83333em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.05017em;"},"children":[{"type":"text","value":"B"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]},{"type":"text","value":", "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"B"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"B_t1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.83333em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.05017em;"},"children":[{"type":"text","value":"B"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"text","value":", "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"B"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"B_t2"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.83333em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.05017em;"},"children":[{"type":"text","value":"B"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"2"}]}]}]}]},{"type":"text","value":", and  "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"B"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"B_t3"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.83333em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.05017em;"},"children":[{"type":"text","value":"B"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"3"}]}]}]}]},{"type":"text","value":" for the current time step by extracting the smooth_path vector at time t into a matrix of the form "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"fence":"true"},"children":[{"type":"text","value":"∣"}]},{"type":"element","tagName":"mtable","properties":{"rowspacing":"0.15999999999999992em","columnspacing":"1em"},"children":[{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"a"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"c"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"b"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"d"}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]}]}]}]},{"type":"element","tagName":"mtr","properties":{},"children":[{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"y"}]}]}]}]},{"type":"element","tagName":"mtd","properties":{},"children":[{"type":"element","tagName":"mstyle","properties":{"scriptlevel":"0","displaystyle":"false"},"children":[{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"element","tagName":"mo","properties":{"fence":"true"},"children":[{"type":"text","value":"∣"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"\\begin{vmatrix}\na & c & 0\\\\\nb & d & 0\\\\\ntx & ty & 1\n\\end{vmatrix}"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:3.636em;vertical-align:-1.5500299999999998em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["minner"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"element","tagName":"span","properties":{"className":["delimsizing","mult"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-1.05597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.6619700000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.26797em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.87397em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.47997em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-4.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500299999999998em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtable"]},"children":[{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"a"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"b"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"x"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"c"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"d"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"t"}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.03588em;"},"children":[{"type":"text","value":"y"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["arraycolsep"],"style":"width:0.5em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["col-align-c"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.05em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-4.21em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.0099999999999993em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.8099999999999994em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:3em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500000000000007em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"element","tagName":"span","properties":{"className":["delimsizing","mult"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:2.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-1.05597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-1.6619700000000002em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.26797em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-2.87397em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-3.47997em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]},{"type":"element","tagName":"span","properties":{"style":"top:-4.08597em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.606em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["delimsizinginner","delim-size1"]},"children":[{"type":"element","tagName":"span","properties":{},"children":[{"type":"text","value":"∣"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:1.5500299999999998em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This is just an affine homography transposed and we then use these to form our three residuals. We then add the appropriate constraints on the residuals according to the paper and these comments:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"-e_t1 <= R_t(p) < e_t1"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.79444em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"<"}]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.36687em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.00773em;"},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.79444em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"-e_t2 <= R_t1(p) - R_t(p) < e_t2"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.79444em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"<"}]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.36687em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.00773em;"},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.00773em;"},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.79444em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"2"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["katex-display"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"mo","properties":{},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"msub","properties":{},"children":[{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"t"}]}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"3"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"-e_t3 <= R_t2(p) - 2R_t1(p) + R_t(p) < e_t3"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.79444em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"3"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"<"}]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.36687em;vertical-align:0em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.00773em;"},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"−"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"2"}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.00773em;"},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mbin"]},"children":[{"type":"text","value":"+"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2222222222222222em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.00773em;"},"children":[{"type":"text","value":"R"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"p"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mrel"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.2777777777777778em;"},"children":[]}]},{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:0.79444em;vertical-align:-0.15em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"e"}]},{"type":"element","tagName":"span","properties":{"className":["msupsub"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-t","vlist-t2"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.2805559999999999em;"},"children":[{"type":"element","tagName":"span","properties":{"style":"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"},"children":[{"type":"element","tagName":"span","properties":{"className":["pstrut"],"style":"height:2.7em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["sizing","reset-size6","size3","mtight"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault","mtight"]},"children":[{"type":"text","value":"t"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-s"]},"children":[{"type":"text","value":"​"}]}]},{"type":"element","tagName":"span","properties":{"className":["vlist-r"]},"children":[{"type":"element","tagName":"span","properties":{"className":["vlist"],"style":"height:0.15em;"},"children":[{"type":"element","tagName":"span","properties":{},"children":[]}]}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"3"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The issue is that we do this element wise manually instead of in vectorized format leading to some issues. I want to say this is because of my inexperience with the package rather than an inherent limitation on the python language and cvxpy in general. If anyone does know how I can vectorize or improve this smoothness constraint I would love to know. I spent a long time trying to vectorize and use slices. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In code the final steps is to just let the convex optimization package solve this for us and upon completion the smooth"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"path variable will be populated. A final bit of post processing is to take each of the n smooth"}]},{"type":"text","value":"path vectors and turn them into n affine homographies and return them in a list.  "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Produce new ‘smooth’ frames"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now that the hard work above is over we can produce new frames. To do so is quite simple take the corners of the crop window centred at the middle of the original frame and warp it according to the smooth path homography we found at the associated time step. The final step is since in our final frame we want the top left corner to correspond to "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"(0, 0)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":", the top right to correspond to "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"(0, w)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02691em;"},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":", bottom left to "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"h"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mn","properties":{},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"(h, 0)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"h"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":", and bottom right to "},{"type":"element","tagName":"span","properties":{"className":["katex"]},"children":[{"type":"element","tagName":"span","properties":{"className":["katex-mathml"]},"children":[{"type":"element","tagName":"math","properties":{},"children":[{"type":"element","tagName":"semantics","properties":{},"children":[{"type":"element","tagName":"mrow","properties":{},"children":[{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"h"}]},{"type":"element","tagName":"mo","properties":{"separator":"true"},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"mi","properties":{},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"mo","properties":{"stretchy":"false"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tagName":"annotation","properties":{"encoding":"application/x-tex"},"children":[{"type":"text","value":"(h, w)"}]}]}]}]},{"type":"element","tagName":"span","properties":{"className":["katex-html"],"ariaHidden":"true"},"children":[{"type":"element","tagName":"span","properties":{"className":["base"]},"children":[{"type":"element","tagName":"span","properties":{"className":["strut"],"style":"height:1em;vertical-align:-0.25em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mopen"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"]},"children":[{"type":"text","value":"h"}]},{"type":"element","tagName":"span","properties":{"className":["mpunct"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mspace"],"style":"margin-right:0.16666666666666666em;"},"children":[]},{"type":"element","tagName":"span","properties":{"className":["mord","mathdefault"],"style":"margin-right:0.02691em;"},"children":[{"type":"text","value":"w"}]},{"type":"element","tagName":"span","properties":{"className":["mclose"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":" we find our final homography by just saying project this warped crop window now into a straight window and produce a final frame."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Results and improvements"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Given that my goal was to revisit the problem to better understand the paper that in itself is a result to me. Along the way I got to revisit my passion for CV, dive deeper into the mathematics behind homographies, and expose myself to field of linear and convex optimizations and linear programming. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This time around the results I produced were more stable than before here is a gif of a short segment the left being the original and the right being my produced frames."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591429800559_ezgif-6-95b7732f1bb5.gif","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Its clear to see that the cropped one has far less motion, the orientation is off and this is because I wasn’t able to smooth over the entire video I had to work with small segments of ~150-300 frames because when the convex optimization package would compile my constraints it would take upwards of hours as more and more frames were added and occasionally memory limits would get hit. I have a feeling if I were able to figure out vectorized formats for the smoothing constraint compilation of the constraints would be faster. In addition, if I could smooth over thousands of frames the orientation would be fixed as it would pick the best that would blend with minimal motions for later frames. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I also plot the x and y motion before and after smoothing to view the results for various segments that took advantage of different motion models. Below are the results with green representing the smoothed motion. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591430248432_motion_0_150.png","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591430248457_motion_300_600.png","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Finally I also wanted to test changes in weight and see what would happen if I only wanted parabolic motion and the resulting graph comes from w1 = w2 = 0, w3 = 100. "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://paper-attachments.dropbox.com/s_E9EF8F33FCFCF502F05C4A7A1663FF7EBCD079E2DD964294142851EA0533EAEB_1591430248479_motion_parabolic.png","className":["gatsby-img-attributes"],"style":"width: 100%;","alt":"null"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"All in all I think the methods in this paper are really really interesting, the thing about computer vision is that you get extremely tangible results. Below are just a collection of different video segments that were smoothed. "}]}],"data":{"quirksMode":false}},"frontmatter":{"date":"June 20, 2020","slug":"/autodirected_video_stabilization","title":"Auto Directed Video Stabilization"}}},"pageContext":{"slug":"/Auto_Directed_Video_Stabilization/"}},"staticQueryHashes":[]}